language: c
cache: ccache
sudo: true
dist: trusty

addons:
  apt:
    packages:
    - build-essential
    - git
    - curl
    - libelf-dev
    - flex
    - bison
    - autoconf
    - python3-pip

before_install:
  - sudo pip3 install --upgrade pip setuptools
  - sudo pip3 install --ignore-installed six
  - sudo pip3 install fusesoc

install:
  - .travis/install-${JOB}.sh

script:
  - .travis/run-${JOB}.sh

jobs:
  fast_finish: true
  allow_failures:
    - env: JOB=or1k-tests SIM=icarus PIPELINE=ESPRESSO
  include:
    - stage: verilator
      env: JOB=verilator
    - stage: testing
      env: JOB=or1k-tests SIM=icarus PIPELINE=CAPPUCCINO EXPECTED_FAILURES="or1k-cy"
    - stage: testing
      env: JOB=or1k-tests SIM=icarus PIPELINE=ESPRESSO

